import{r as b,j as e,B as c,O as G}from"./app-DN9_gzYd.js";import{b as T,F as M,T as P,a as D,A as H,S as f,G as a,B as W,j as K,k as t}from"./AppLayout-PfUEuSbw.js";import{B as O}from"./Breadcrumbs-DcIMFZ2R.js";import{T as h,b as J,I as U}from"./Table-CHL3rbco.js";import{S as _}from"./Select-B6qgNClG.js";import{I as F,G as l}from"./IconCalendar-CFMiNxSf.js";import{S as q}from"./SimpleGrid-DKkKqUTd.js";import{D as Q}from"./Divider-CdrkPNhK.js";import{T as y}from"./Title-DYxjYiRb.js";import{L as R,T as V}from"./TypographyStylesProvider-66YQPa5B.js";import{C as o}from"./Center-iDPJCgw-.js";import"./ScrollArea-CdgOV-zf.js";import"./OptionsDropdown-BfQyMBsN.js";import"./CheckIcon-NyLAEMeP.js";import"./get-base-value-CMkFMZzm.js";const pe=r=>{var L;console.log(r);const[w,p]=b.useState(null),C=w===null?r.evaluations:r.evaluations.filter(s=>s.period===Number(w)),[I,X]=b.useState(""),z=[{title:"#"},{title:"Foto"},{title:"Nama Lengkap",key:"full_name"},{title:"Sistem Pertandingan",key:"role"},{title:"Aksi"}],B=s=>{var i;return(i=C.find(n=>n.id===s))==null?void 0:i.tournaments.reduce((n,d)=>d.medal==="Emas"?n+3:d.medal==="Perak"?n+2:d.medal==="Perunggu"?n+1:n,0)},N=[{label:"Rincian Laporan",icon:e.jsx(U,{}),onClick:s=>G.get(route("reports.show",s.id)),color:"blue"}],S=(L=r.athletes)==null?void 0:L.filter(s=>s.full_name.replace(/\s/g,"").toLowerCase().match(new RegExp(I.replace(/\s/g,"").toLowerCase(),"i"))),[m,v]=b.useState(S),A=m==null?void 0:m.map((s,i)=>e.jsxs(h.Tr,{h:64,children:[e.jsx(h.Td,{px:16,py:0,style:{whiteSpace:"nowrap"},children:i+1}),e.jsx(h.Td,{px:16,py:0,style:{whiteSpace:"nowrap"},children:e.jsx(T,{src:s.avatar,alt:s.full_name})}),e.jsx(h.Td,{px:16,py:0,style:{whiteSpace:"nowrap"},children:s.full_name}),e.jsx(h.Td,{px:16,py:0,style:{whiteSpace:"nowrap"},children:s.role}),e.jsx(h.Td,{px:16,py:0,style:{whiteSpace:"nowrap"},children:e.jsx(M,{gap:8,style:{whiteSpace:"nowrap"},children:N.map((n,d)=>e.jsx(P,{label:n.label,style:{borderRadius:32,padding:".5rem 1rem"},children:e.jsx(D,{size:48,radius:32,variant:"subtle","aria-label":n.label,color:n.color,onClick:()=>n.onClick(s),disabled:r.auth.user.id===s.id||n.disabled,children:n.icon})},d))})})]},i)),$=s=>{v(s)};return e.jsxs(H,{title:"Laporan",authed:r.auth.user,meta:r.meta,unreadHistories:r.total_unread_histories,children:[e.jsxs(f,{mb:32,children:[e.jsxs(a,{w:"100%",justify:"space-between",children:[e.jsx(O,{navList:[{label:"Laporan"}]}),["Ne-Waza","Fighting"].includes(r.auth.user.role)&&e.jsxs(a,{children:[e.jsx(_,{display:{base:"none",xs:"block"},w:240,leftSection:e.jsx(F,{}),placeholder:"Pilih periode...",variant:"filled",clearable:!0,searchable:!0,nothingFoundMessage:"Tidak ada periode ditemukan",checkIconPosition:"right",onChange:s=>{p(s===null?null:s)},data:r.evaluations.map(s=>({label:`${s.period}`,value:`${s.period}`})),allowDeselect:!0,styles:{label:{marginBottom:8},input:{height:48,borderRadius:32,paddingLeft:50,paddingRight:16},section:{marginLeft:0,width:48,height:48},error:{marginTop:8}}}),r.auth.user.role.includes("Pelatih")&&e.jsxs(e.Fragment,{children:[e.jsx(P,{style:{borderRadius:32,padding:".5rem 1rem"},label:"Cetak",children:e.jsx(D,{ml:"auto",h:48,w:48,color:"gold.2",radius:32,display:{base:"block",sm:"none"},onClick:()=>window.print(),children:e.jsx(IconPrinter,{})})}),e.jsx(W,{display:{base:"none",sm:"block"},w:240,leftSection:e.jsx(IconPrinter,{}),variant:"filled",color:"gold.2",h:48,radius:32,px:16,styles:{section:{marginRight:12}},onClick:()=>window.print(),children:"Cetak"})]})]})]}),["Ne-Waza","Fighting"].includes(r.auth.user.role)&&e.jsx(_,{w:"100%",clearable:!0,searchable:!0,allowDeselect:!0,nothingFoundMessage:"Tidak ada periode ditemukan",display:{base:"block",xs:"none"},leftSection:e.jsx(F,{}),placeholder:"Pilih periode...",variant:"filled",checkIconPosition:"right",onChange:s=>{p(s===null?null:s)},data:r.evaluations.map(s=>({label:`${s.period}`,value:`${s.period}`})),styles:{label:{marginBottom:8},input:{height:48,borderRadius:32,paddingLeft:50,paddingRight:16},section:{marginLeft:0,width:48,height:48},error:{marginTop:8}}})]}),["Ne-Waza","Fighting"].includes(r.auth.user.role)?e.jsxs(f,{gap:80,children:[e.jsxs(l,{align:"center",children:[e.jsx(l.Col,{span:4,children:e.jsx(T,{src:r.auth.user.avatar,alt:r.auth.user.full_name,size:160})}),e.jsx(l.Col,{span:8,children:e.jsxs(q,{cols:2,children:[e.jsxs(c,{children:[e.jsx(t,{children:"Nama Lengkap :"}),e.jsx(t,{fw:600,children:r.auth.user.full_name})]}),e.jsxs(c,{children:[e.jsx(t,{children:"Jenis Kelamin :"}),e.jsx(t,{fw:600,children:r.auth.user.gender})]}),e.jsxs(c,{children:[e.jsx(t,{children:"Tanggal Lahir :"}),e.jsx(t,{fw:600,children:new Date(r.auth.user.birth_date).toLocaleDateString("id").split("/").join("-")})]}),e.jsxs(c,{children:[e.jsx(t,{children:"Alamat Surel :"}),e.jsx(t,{fw:600,children:r.auth.user.email})]}),e.jsxs(c,{children:[e.jsx(t,{children:"Sistem Pertandingan :"}),e.jsx(t,{fw:600,children:r.auth.user.role})]}),e.jsxs(c,{children:[e.jsx(t,{children:"Berat Badan :"}),e.jsxs(t,{fw:600,children:[r.auth.user.athlete.weight," kg"]})]})]})})]}),C.map(s=>e.jsxs(f,{gap:32,children:[e.jsx(Q,{label:`Periode ${s.period} (${new Date(s.start_date).toLocaleDateString("id").split("/").join("-")} - ${new Date(s.end_date).toLocaleDateString("id").split("/").join("-")})`,labelPosition:"center",styles:{label:{fontSize:14}}}),s.exercises.length&&e.jsxs(c,{children:[e.jsx(y,{fz:26,mb:8,children:"Daftar Latihan"}),e.jsx(R,{type:"ordered",children:s.exercises.map(i=>e.jsxs(R.Item,{children:[i.name," di ",i.place," pada",new Date(i.date).toLocaleDateString("id").split("/").join("-")]},i.id))})]}),s.tournaments.length&&e.jsxs(c,{children:[e.jsx(y,{fz:26,mb:8,children:"Daftar Pertandingan"}),e.jsxs(l,{gutter:0,children:[e.jsx(l.Col,{span:9,children:e.jsx(a,{style:{border:"1px solid #e1e1e1"},px:16,h:48,fw:600,children:"Nama Pertandingan"})}),e.jsx(l.Col,{span:3,children:e.jsx(o,{style:{border:"1px solid #e1e1e1"},px:16,h:48,fw:600,children:"Medali (Poin)"})}),e.jsx(l.Col,{span:9,children:e.jsx(a,{style:{border:"1px solid #e1e1e1"},px:16,h:48,fw:600})}),e.jsx(l.Col,{span:1,children:e.jsx(o,{style:{border:"1px solid #e1e1e1"},px:16,h:48,fw:600,children:"Emas (3)"})}),e.jsx(l.Col,{span:1,children:e.jsx(o,{style:{border:"1px solid #e1e1e1"},px:16,h:48,fw:600,children:"Perak (2)"})}),e.jsx(l.Col,{span:1,children:e.jsx(o,{style:{border:"1px solid #e1e1e1"},px:16,h:48,fw:600,children:"Perunggu (1)"})}),s.tournaments.map(i=>e.jsxs(e.Fragment,{children:[e.jsx(l.Col,{span:9,children:e.jsx(a,{style:{border:"1px solid #e1e1e1"},px:16,h:48,children:i.name})}),e.jsx(l.Col,{span:1,children:e.jsx(o,{style:{border:"1px solid #e1e1e1"},px:16,h:48,children:i.medal==="Emas"?1:"-"})}),e.jsx(l.Col,{span:1,children:e.jsx(o,{style:{border:"1px solid #e1e1e1"},px:16,h:48,children:i.medal==="Perak"?1:"-"})}),e.jsx(l.Col,{span:1,children:e.jsx(o,{style:{border:"1px solid #e1e1e1"},px:16,h:48,children:i.medal==="Perunggu"?1:"-"})})]})),e.jsx(l.Col,{span:9,children:e.jsx(a,{style:{border:"1px solid #e1e1e1"},px:16,h:48,children:"Total"})}),e.jsx(l.Col,{span:3,children:e.jsx(o,{style:{border:"1px solid #e1e1e1"},px:16,h:48,children:B(s.id)})})]})]}),e.jsxs(c,{children:[e.jsx(y,{fz:26,mb:8,children:"Daftar Penilaian"}),e.jsxs(l,{gutter:0,children:[e.jsx(l.Col,{span:11,children:e.jsx(a,{style:{border:"1px solid #e1e1e1"},px:16,h:48,fw:600,children:"Kriteria"})}),e.jsx(l.Col,{span:1,children:e.jsx(o,{style:{border:"1px solid #e1e1e1"},px:16,h:48,fw:600,children:"Nilai"})}),s.criterias.map((i,n)=>e.jsxs(e.Fragment,{children:[e.jsx(l.Col,{children:e.jsx(o,{style:{border:"1px solid #e1e1e1"},px:16,h:48,fw:600,children:i.name.toUpperCase()})},n),i.sub_criterias.map((d,j)=>{const g=String.fromCharCode(65+j);return e.jsxs(e.Fragment,{children:[e.jsx(l.Col,{children:e.jsxs(a,{style:{border:"1px solid #e1e1e1"},px:16,fw:600,h:48,children:[g,". ",d.name]})},j),d.sub_sub_criterias.map((u,x)=>e.jsxs(e.Fragment,{children:[e.jsx(l.Col,{span:11,children:e.jsxs(a,{style:{border:"1px solid #e1e1e1"},px:16,h:48,children:[x+1,". ",u.name]})},x),e.jsx(l.Col,{span:1,children:e.jsx(a,{style:{border:"1px solid #e1e1e1"},px:16,h:48,children:u.evaluation.value})})]}))]})}),i.type==="radio"&&e.jsxs(e.Fragment,{children:[e.jsx(l.Col,{span:11,children:e.jsx(a,{style:{border:"1px solid #e1e1e1"},px:16,h:48,children:"Rata-rata"})}),e.jsx(l.Col,{span:1,children:e.jsx(a,{style:{border:"1px solid #e1e1e1"},px:16,h:48,children:(()=>{let d=0;const j=i.sub_criterias.reduce((g,u)=>{const x=u.sub_sub_criterias.reduce((k,E)=>({sum:k.sum+Number(E.evaluation.value),count:k.count+1}),{sum:0,count:0});return d+=x.count,g+x.sum},0);return Number((j/d).toFixed(2))})()})})]})]})),e.jsx(l.Col,{span:12,children:e.jsxs(a,{style:{overflow:"auto",border:"1px solid #e1e1e1"},px:16,py:11,children:[e.jsx(t,{fw:600,children:"Catatan : "}),e.jsx(V,{children:e.jsx("div",{dangerouslySetInnerHTML:{__html:s.note}})})]})})]})]})]},s.id))]}):e.jsx(J,{thList:z,tdList:A,icon:e.jsx(K,{size:48}),title:"Laporan",data:S,handleSort:$})]})};export{pe as default};
